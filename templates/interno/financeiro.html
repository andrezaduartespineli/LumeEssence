<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Financeiro | Lume Essence Admin</title>
    <link rel="icon" href="/static/imagens/Logo/grandelogosemfundo.png">
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400;600&family=Quicksand:wght@400;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="/static/styleinterno.css">
</head>
<body>

    <div class="admin-container">
        
        <aside class="sidebar">
            <div class="sidebar-header">
                <h2 class="brand-text">LUME <span>ADMIN</span></h2>
            </div>
            <nav class="sidebar-nav">
                <ul>
                    <li><a href="dashboard.html"><i class="fa-solid fa-chart-line"></i> Visão Geral</a></li>
                    <li><a href="pedido.html"><i class="fa-solid fa-bag-shopping"></i>Pedidos</a></li>
                    <li><a href="produto.html"><i class="fa-solid fa-box-open"></i> Produtos</a></li>
                    <li><a href="fornecedores.html"><i class="fa-solid fa-truck-fast"></i> Fornecedores</a></li>
                    <li><a href="funcionarios.html"><i class="fa-solid fa-users"></i> Funcionários</a></li>
                    <li class="active"><a href="financeiro.html"><i class="fa-solid fa-file-invoice-dollar"></i> Financeiro</a></li>
                    <li><a href="cliente.html"><i class="fas fa-user"></i>Clientes</a></li>
                    <li><a href="newsletter.html"><i class="fa-solid fa-envelope-open-text"></i> Newsletter</a></li>
                    <li><a href="mensagens.html"><i class="fa-regular fa-comment-dots"></i> Mensagens</a></li>
                    <li class="separator"></li>
                    <li><a href="configuracoes.html"><i class="fa-solid fa-gear"></i> Configurações</a></li>
                </ul>
            </nav>
            <div class="sidebar-footer">
                <a href="login.html" class="logout-btn"><i class="fa-solid fa-right-from-bracket"></i> Sair</a>
            </div>
        </aside>

        <main class="main-content">
            
            <header class="top-bar">
                <div class="welcome-text">
                    <h1>Controle Financeiro</h1>
                    <p>Fluxo de caixa e balanço mensal.</p>
                </div>
                <div class="user-profile">
    <div class="profile-dropdown-trigger" onclick="toggleProfileMenu()">
        <img src="/static/imagens/fundadora1.jpeg" alt="Admin" class="avatar">
    </div>

    <div class="profile-dropdown-menu" id="profileMenu">
        <ul>
            <li>
                <a href="configuracoes.html">
                    <i class="fa-regular fa-user"></i> Meu Perfil
                </a>
            </li>
            <li>
                <a href="#">
                    <i class="fa-solid fa-rotate"></i> Trocar Usuário
                </a>
            </li>
            <li class="separator"></li> <li>
                <a href="/login" class="text-danger">
                    <i class="fa-solid fa-right-from-bracket"></i> Sair do Sistema
                </a>
            </li>
        </ul>
    </div>
</div>
            </header>

            <section class="finance-summary">
                
                <div class="card finance-card income">
    <div class="icon-box"><i class="fa-solid fa-arrow-trend-up"></i></div>
    <div class="finance-info">
        <span>Entradas (Total)</span>
        <h3>R$ {{ "%.2f"|format(total_receitas) }}</h3>
    </div>
</div>

<div class="card finance-card expense">
    <div class="icon-box"><i class="fa-solid fa-arrow-trend-down"></i></div>
    <div class="finance-info">
        <span>Saídas (Total)</span>
        <h3>R$ {{ "%.2f"|format(total_despesas) }}</h3>
    </div>
</div>

<div class="card finance-card balance">
    <div class="icon-box"><i class="fa-solid fa-wallet"></i></div>
    <div class="finance-info">
        <span>Saldo Líquido</span>
        <h3>R$ {{ "%.2f"|format(saldo) }}</h3>
    </div>
</div>
            </section>

            <section class="toolbar">
                <div class="status-filters">
    <a href="/financeiro?filtro=atual" 
       class="tab-btn {{ 'active' if filtro_atual == 'atual' }}">
       Este Mês
    </a>

    <a href="/financeiro?filtro=anterior" 
       class="tab-btn {{ 'active' if filtro_atual == 'anterior' }}">
       Mês Passado
    </a>

    <a href="/financeiro?filtro=todos" 
       class="tab-btn {{ 'active' if filtro_atual == 'todos' }}">
       Todos
    </a>
</div>
                <div class="action-buttons">
                    <button class="btn-expense"><i class="fa-solid fa-minus"></i> Nova Despesa</button>
                    <button class="btn-income"><i class="fa-solid fa-plus"></i> Nova Receita</button>
                </div>
            </section>

            <section class="transactions-section">
                <div class="section-header">
                    <h2>Extrato Recente</h2>
                    <a href="#" class="view-all">Ver Relatório Completo</a>
                </div>

                <div class="table-responsive">
                    <table class="finance-table">
                        <thead>
                            <tr>
                                <th>Data</th>
                                <th>Descrição</th>
                                <th>Categoria</th>
                                <th>Status</th>
                                <th class="text-right">Valor</th>
                                <th></th>
                            </tr>
                        </thead>
                        <tbody>
    {% for item in extrato %}
    <tr>
        <td>{{ item['data'] }}</td>
        
        <td><strong>{{ item['descricao'] }}</strong></td>
        
        <td>{{ item['categoria'] }}</td>
        
        <td>
            {% if item['status'] == 'Pago' or item['status'] == 'Recebido' %}
                <span class="badge success">{{ item['status'] }}</span>
            {% else %}
                <span class="badge warning">{{ item['status'] }}</span>
            {% endif %}
        </td>

        {% if item['tipo'] == 'entrada' %}
            <td class="text-right value-income">+ R$ {{ "%.2f"|format(item['valor']) }}</td>
        {% else %}
            <td class="text-right value-expense">- R$ {{ "%.2f"|format(item['valor']) }}</td>
        {% endif %}

        <td class="action-col"><i class="fa-solid fa-ellipsis"></i></td>
    </tr>
    {% else %}
    <tr>
        <td colspan="6" style="text-align: center; padding: 20px; color: #999;">
            Nenhuma movimentação financeira registrada.
        </td>
    </tr>
    {% endfor %}
</tbody>
                    </table>
                </div>
            </section>

        </main>
    </div>


<div id="modal-receita" class="modal-backdrop">
        <div class="modal-box slide-down">
            <div class="modal-header">
                <h2><i class="fa-solid fa-arrow-trend-up"></i> Nova Receita</h2>
                <button class="btn-close-modal" onclick="fecharModalReceita()">
                    <i class="fa-solid fa-xmark"></i>
                </button>
            </div>

            <form class="modal-form" action="/financeiro/receita/nova" method="POST">
    <div class="input-group">
        <label>Descrição da Venda/Entrada</label>
        <input type="text" name="descricao" placeholder="Ex: Venda Corporativa - Lote 50 Velas" required>
    </div>

    <div class="form-row-2">
        <div class="input-group">
            <label>Data de Emissão</label>
            <input type="date" name="data_emissao" id="data-despesa">
        </div>
        <div class="input-group">
            <label>Data Vencimento/Recebimento</label>
            <input type="date" name="data_venc" id="data-hoje" required>
        </div>
    </div>
    
    <div class="input-group">
        <label>Valor (R$)</label>
        <input type="number" name="valor" placeholder="0,00" step="0.01" class="input-green" required>
    </div>

    <div class="form-row-2">
        <div class="input-group">
            <label>Categoria</label>
            <select name="categoria">
                <option value="Venda Online">Venda Loja Online</option>
                <option value="Venda B2B">Venda Corporativa (B2B)</option>
                <option value="Investimento">Rendimento de Investimento</option>
                <option value="Outros">Outros</option>
            </select>
        </div>
        <div class="input-group">
            <label>Status</label>
            <select name="status">
                <option value="Recebido">Recebido (Pago)</option>
                <option value="Pendente">Pendente (A receber)</option>
            </select>
        </div>
    </div>

                <div class="modal-footer">
        <button type="button" class="btn-ghost" onclick="fecharModalReceita()">Cancelar</button>
        <button type="submit" class="btn-confirm-income">Confirmar Entrada</button>
    </div>
            </form>
        </div>
    </div>

     
<div id="modal-despesa" class="modal-backdrop">
        <div class="modal-box slide-down">
            <div class="modal-header">
                <h2 style="color: var(--danger);"><i class="fa-solid fa-arrow-trend-down"></i> Nova Despesa</h2>
                <button class="btn-close-modal" onclick="fecharModalDespesa()">
                    <i class="fa-solid fa-xmark"></i>
                </button>
            </div>

            <form class="modal-form" action="/financeiro/despesa/nova" method="POST">
    <div class="input-group">
        <label>Descrição da Despesa</label>
        <input type="text" name="descricao" placeholder="Ex: Conta de Luz - Ateliê" required>
    </div>

    <div class="form-row-2">
        <div class="input-group">
            <label>Valor (R$)</label>
            <input type="number" name="valor" placeholder="0,00" step="0.01" class="input-red" required>
        </div>
        
        <div class="input-group">
            <label>Data Vencimento</label>
            <input type="date" name="data_venc" id="data-despesa" required>
        </div>
    </div>
          
    <div class="form-row-2">
        <div class="input-group">
            <label>Categoria</label>
            <select name="categoria">
                <option value="Materia-prima">Matéria-prima (Cera/Essência)</option>
                <option value="Embalagens">Embalagens e Vidros</option>
                <option value="Logistica">Logística e Frete</option>
                <option value="Marketing">Marketing e Anúncios</option>
                <option value="Infraestrutura">Infraestrutura (Luz/Água)</option>
                <option value="Pessoal">Folha de Pagamento</option>
                <option value="Impostos">Impostos</option>
                <option value="Outros">Outros</option>
            </select>
        </div>
        <div class="input-group">
            <label>Status</label>
            <select name="status">
                <option value="Pendente">Pendente (A pagar)</option>
                <option value="Pago">Pago</option>
                <option value="Agendado">Agendado</option>
            </select>
        </div>
    </div>

    <div class="input-group">
        <label>Fornecedor (Opcional)</label>
        <input type="text" name="fornecedor" placeholder="Busque ou digite o nome...">
    </div>

    <div class="modal-footer">
        <button type="button" class="btn-ghost" onclick="fecharModalDespesa()">Cancelar</button>
        <button type="submit" class="btn-confirm-expense">Registrar Saída</button>
    </div>
</form>


        </div>
    </div>
    <script src="/static/scriptinterno.js"></script>
</body>
</html>