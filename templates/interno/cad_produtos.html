<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{ 'Editar Produto' if produto else 'Novo Produto' }} | Lume Essence Admin</title>
    <link rel="icon" href="/static/imagens/Logo/grandelogosemfundo.png">
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400;600&family=Quicksand:wght@400;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="/static/styleinterno.css">
</head>
<body>

    <div class="admin-container">
        
        <aside class="sidebar">
            <div class="sidebar-header">
                <h2 class="brand-text">LUME <span>ADMIN</span></h2>
            </div>
            <nav class="sidebar-nav">
                <ul>
                    <li><a href="dashboard.html"><i class="fa-solid fa-chart-line"></i> Visão Geral</a></li>
                    <li><a href="pedido.html"><i class="fa-solid fa-bag-shopping"></i>Pedidos</a></li>
                    <li class="active"><a href="produto.html"><i class="fa-solid fa-box-open"></i> Produtos</a></li>
                    <li><a href="fornecedores.html"><i class="fa-solid fa-truck-fast"></i> Fornecedores</a></li>
                    <li><a href="funcionarios.html"><i class="fa-solid fa-users"></i> Funcionários</a></li>
                    <li><a href="financeiro.html"><i class="fa-solid fa-file-invoice-dollar"></i> Financeiro</a></li>
                    <li><a href="cliente.html"><i class="fas fa-user"></i>Clientes</a></li>
                    <li class="separator"></li>
                    <li><a href="configuracoes.html"><i class="fa-solid fa-gear"></i> Configurações</a></li>
                </ul>
            </nav>
            <div class="sidebar-footer">
                <a href="login.html" class="logout-btn"><i class="fa-solid fa-right-from-bracket"></i> Sair</a>
            </div>
        </aside>

        <main class="main-content">
            
            <header class="top-bar">
                <div class="welcome-text">
                    <h1>{{ 'Editar Produto' if produto else 'Cadastrar Produto' }}</h1>
                    <p>Gerencie o catálogo da loja.</p>
                </div>
                <div class="user-profile">
                    <div class="profile-dropdown-trigger" onclick="toggleProfileMenu()">
                        <img src="/static/imagens/fundadora1.jpeg" alt="Admin" class="avatar">
                    </div>
                    <div class="profile-dropdown-menu" id="profileMenu">
                        <ul>
                            <li><a href="configuracoes.html"><i class="fa-regular fa-user"></i> Meu Perfil</a></li>
                            <li class="separator"></li> 
                            <li><a href="/login" class="text-danger"><i class="fa-solid fa-right-from-bracket"></i> Sair</a></li>
                        </ul>
                    </div>
                </div>
            </header>

            <form class="product-form-container" 
                  action="{{ '/produto/atualizar' if produto else '/produto/novo' }}" 
                  method="POST" enctype="multipart/form-data">

                {% if produto %}
                    <input type="hidden" name="id_produto" value="{{ produto['id_produto'] }}">
                {% endif %}
                
                <div class="form-header">
                    <h2>{{ 'Editar Informações' if produto else 'Informações do Item' }}</h2>
                    <div class="form-actions">
                        <a href="/produtos" class="btn-cancel">Cancelar</a>
                        <button type="submit" class="btn-save">{{ 'Salvar Alterações' if produto else 'Cadastrar Produto' }}</button>
                    </div>
                </div>

                <div class="form-grid">
                    <div class="left-column">
                        
                        <div class="input-group">
                            <label>Nome do Produto</label>
                            <input type="text" name="nome_produto" placeholder="Nome do Produto"
                                   value="{{ produto['nome_produto'] if produto else '' }}" required>
                        </div>

                        <div class="input-group">
                            <label>Fornecedor</label>
                            <input type="text" name="fornecedor" placeholder="Ex: Fabricação Própria"
                                   value="{{ produto['fornecedor'] if produto else '' }}" required>
                        </div>

                        <div class="form-row-3">
                            <div class="input-group">
                                <label>Categoria</label>
                                <select id="categoria" name="categoria" onchange="atualizarTamanhos()">
                                    <option value="Velas Aromáticas">Velas Aromáticas</option>
                                    <option value="Home Spray">Home Spray</option>
                                    <option value="Difusores">Difusores</option>
                                    <option value="Kits Presente">Kits Presente</option>
                                </select>
                            </div>
                            <div class="input-group">
                                <label>Aroma (Família Olfativa)</label>
                                <select id="aroma" name="aroma">
                                    <option value="Alecrim">Alecrim</option>
                                    <option value="Baunilha">Baunilha</option>
                                    <option value="Lavanda">Lavanda</option>
                                    <option value="Bamboo">Bamboo</option>
                                    <option value="Limão Siciliano">Limão Siciliano</option>
                                    <option value="Jasmim">Jasmim</option>
                                    <option value="Coco">Coco</option>
                                    <option value="Morango">Morango</option>
                                    <option value="Flor de Algodão">Flor de Algodão</option>
                                    <option value="Capim Limão">Capim Limão</option>
                                    <option value="Chocolate">Chocolate</option>
                                    <option value="Chá Branco">Chá Branco</option>
                                    <option value="Sem Aroma (Neutro)">Sem Aroma (Neutro)</option>
                                    <option value="Outro">Outro</option>
                                </select>
                            </div>
                            <div class="input-group">
                                <label id="label-tamanho">Variação</label>
                                <select id="variacao" name="variacao">
                                    <option value="100g">100g</option>
                                    <option value="150g">150g</option>
                                    <option value="230g">230g</option>
                                    <option value="300g">300g</option>
                                    <option value="330g">330g</option>
                                    <option value="30ml">30ml</option>
                                    <option value="50ml">50ml</option>
                                    <option value="100ml">100ml</option>
                                    <option value="150ml">150ml</option>
                                    <option value="250ml">250ml</option>
                                    <option value="300ml">300ml</option>
                                    <option value="500ml">500ml</option>
                                    <option value="Kit Presente Pequeno">Kit Presente Pequeno</option>
                                    <option value="Kit Presente Médio">Kit Presente Médio</option>  
                                    <option value="Kit Presente Grande">Kit Presente Grande</option>
                                    <option value="Kit Presente">Kit Presente</option>
                                    
                                </select>
                            </div>
                        </div>

                        <div class="form-row-2">
                            <div class="input-group">
                                <label>Código (SKU)</label>
                                <input type="text" name="sku" placeholder="Ex: LUME-001"
                                       value="{{ produto['sku'] if produto else '' }}" required>
                            </div>
                            <div class="input-group">
                                <label>Estoque Inicial</label>
                                <input type="number" name="qtd_estoque" placeholder="Quantidade em Estoque"
                                       value="{{ produto['qtd_estoque'] if produto else '' }}" required>
                            </div>
                        </div>

                        <div class="form-row-2">
                            <div class="input-group">
                                <label>Preço de Custo (R$)</label>
                                <input type="number" name="preco_custo" step="0.01" placeholder="Preço de Custo"
                                       value="{{ produto['preco_custo'] if produto else '' }}" required>
                            </div>
                            <div class="input-group">
                                <label>Preço de Venda (R$)</label>
                                <input type="number" name="preco_venda" step="0.01" placeholder= "Preço de Venda"
                                       value="{{ produto['preco_venda'] if produto else '' }}" required>
                            </div>
                        </div>

                        <div class="input-group">
                            <label>Data de Cadastro</label>
                            <input type="date" id="data-cadastro" name="data_cad" 
                                   value="{{ produto['data_cad'] if produto else '' }}" 
                                   readonly style="background-color: #e9ecef;">
                        </div>

                        <div class="input-group">
                            <label>Descrição Completa</label>
                            <textarea rows="4" name="descricao" placeholder="" required>{{ produto['descricao'] if produto else '' }}</textarea>
                        </div>
                    </div>

                    <div class="right-column">
                        <div class="upload-card">
                            <label>Imagem Principal</label>
                            
                            {% if produto and produto['img_produto'] %}
                                <div style="margin-bottom: 15px; text-align: center;">
                                    <img src="../../static/uploads/{{ produto['img_produto'] }}" 
                                         onerror="this.src='../../static/imagens/sem_foto.png'"
                                         style="width: 120px; height: 120px; object-fit: cover; border-radius: 8px; border: 1px solid #ddd;">
                                    <p style="font-size: 0.8rem; color: #666; margin-top: 5px;">Imagem Atual</p>
                                </div>
                            {% endif %}

                            <div class="drop-zone">
                                <i class="fa-solid fa-cloud-arrow-up"></i>
                                <p>{{ 'Clique para substituir a foto' if produto else 'Arraste a foto aqui' }}</p>
                                <input type="file" name="img_produto" accept="image/*">
                            </div>
                        </div>
                    </div>
                    <div class="right-column" style="display: flex; gap: 10px; align-items: center;">
   
                                <form action="/importar_csv" method="POST" enctype="multipart/form-data" style="display: flex; gap: 5px;">
                                    <input type="file" name="arquivo_csv" accept=".csv" required
                                        style="font-size: 0.8rem; padding: 5px; border: 1px solid #ddd; border-radius: 5px; background: white;">
                                    <button type="submit" class="btn-action" style="background: #27ae60; color: white; border: none;">
                                        <i class="fa-solid fa-file-import"></i> Importar
                                    </button>
                                </form>

                                <a href="/gerar_planilha_padrao" class="btn-action" style="text-decoration: none; color: #555;">
                                    <i class="fa-solid fa-download"></i> Baixar Modelo
                                </a>

                                <form class="search-compact" action="/produtos" method="GET">
                                    <button type="submit" style="border: none; background: transparent; cursor: pointer; color: #ccc;">
                                        <i class="fa-solid fa-magnifying-glass"></i>
                                    </button>
                                    <input type="text" name="q" placeholder="Buscar..." value="{{ request.args.get('q', '') }}">
                                </form>
                            </div>
                </div>
            </form>

        </main>
    </div>
    <script src="/static/scriptinterno.js"></script>
</body>
</html>